# This file (and others in `conf/`) specify some static parameters,
# as well as some which will be 'swept' over for experiments.

defaults:
  - _self_

# ===== Common parameters for all benchmarks =====
s3_bucket: ???
application_workers: 1
iterations: 1
run_time: 30  # Default run time in seconds
read_part_size: !!null
write_part_size: 16777216  # 16 MiB, to allow for uploads of large files
object_size_in_gib: 100  # Size of the object to benchmark
benchmark_type: "fio"

# Network configuration
network:
  interface_names: []
  maximum_throughput_gbps: !!null

# Monitoring options (common to all benchmarks)
monitoring:
  with_bwm: false
  with_perf_stat: false

# ===== Mountpoint configuration =====
mountpoint:
  fuse_threads: !!null
  prefix: !!null
  metadata_ttl: "indefinite"
  mountpoint_max_background: !!null
  mountpoint_congestion_threshold: !!null
  mountpoint_binary: !!null
  upload_checksums: !!null
  stub_mode: "off"  # Options: "off", "fs_handler", "s3_client"
  mountpoint_debug: false
  mountpoint_debug_crt: false

# ===== Benchmark-specific configurations =====
# FIO benchmark configuration
benchmarks:
  fio:
    direct_io: false
    fio_benchmarks:
      - sequential_read
    fio_benchmark: "${benchmarks.fio.fio_benchmarks[0]}"
    fio_io_engine: "psync"

iteration: 0

hydra:
  help:
    app_name: "Mountpoint benchmark runner"
  mode: MULTIRUN
  job:
    chdir: true
  sweeper:
    params:
      # Number of processes that will be interacting with the file.
      'application_workers': 1, 4, 8, 16, 32, 64, 128, 256
      'iteration': "range(${iterations})"
      # MP/FIOspecific parameters
      'mountpoint.fuse_threads': 16, 32, 64, 128
      # Configure if application should use Direct IO, skipping the Linux page cache
      'benchmarks.fio.direct_io': false, true
      'benchmarks.fio.fio_benchmark': "${join:',', ${benchmarks.fio.fio_benchmarks}}"
